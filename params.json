{"name":"Toptaus","tagline":"Port of my repository http://cmssw.cvs.cern.ch/cgi-bin/cmssw.cgi/UserCode/LIP/TopTaus/ for Charged Higgs and ttbar xsec analyses to git.","body":"-----------------------------------\r\nRepository for tauDilepton analysis\r\n-----------------------------------\r\n* This is the manual. Read the fucking manual +BEFORE+ running the code.\r\n\r\n* For help: pietro.vischia atPlzNoSpam gmail.com / pietro.vischia atPlzNoSpam cern.ch\r\n\r\n* Will work for ttbar cross section measurement as well as charged higgs search/tau polarization\r\n\r\n* This started as a porting to a compiled binary approach like LIP/Top, in order\r\nto remove levels of messiness in the original code to be compiled every time together with\r\nits libraries - whoah running time is already 1/2 than before, LoL\r\n\r\n* MOVED TO GITHUB.COM ON APRIL 30th, 2013 because of CERN CVS service shutdown\r\n\r\n------------\r\nInstallation\r\n------------\r\n\r\n# 537\r\nsetenv SCRAM_ARCH slc5_amd64_gcc462\r\nscramv1 project CMSSW CMSSW_5_3_7_patch4\r\ncd CMSSW_5_3_7_patch4/src/\r\ncmsenv\r\ncvs co -p UserCode/LIP/TopTaus/TAGS_2012.txt | sh\r\nscram b -j8\r\n\r\n# Production version for Higgs Combination Tool\r\nsetenv SCRAM_ARCH slc5_amd64_gcc472 \r\ncmsrel CMSSW_6_1_1 ### must be >= 6.1.1, as older versions have bugs\r\ncd CMSSW_6_1_1/src \r\ncmsenv\r\naddpkg HiggsAnalysis/CombinedLimit V03-01-08\r\nscramv1 b\r\n\r\n# 444\r\nsetenv SCRAM_ARCH slc5_amd64_gcc434\r\nscramv1 project CMSSW CMSSW_4_4_4\r\ncd CMSSW_4_4_4/src\r\ncvs co -p UserCode/LIP/TopTaus/TAGS_2011.txt | sh\r\n\r\n---------------------------------\r\nInstructions for running analysis\r\n---------------------------------\r\n\r\n# Local pattuple test run (local data file at LIP)\r\n# obsolete, must update: cmsRun LIP/TopTaus/test/createDataPattuple_cfg.py /lustre/data3/cmslocal/samples/CMSSW_5_2_5/test/Run2012B_SingleMu_AOD_PromptReco-v1_000_193_998_0C7DCC80-4E9D-E111-B22A-001D09F25267.root pattuple.root inclusive_mu\r\n\r\n\r\nFinding HLT trigger on a per-run-range basis, together with the prescale\r\n------------------------------------------------------------------------\r\nssh lxplus.cern.ch # needed for access to database\r\ncvs co HLTrigger/Tools/python\r\nscram b\r\ncd HLTrigger/Tools/python\r\nsource $CMSSW_BASE/LIP/TopTaus/scripts/getTriggers.sh\r\nThis will fetch the list of triggers, and depending on what you comment will print or not the prescales table. (see TODO list)\r\n\r\n\r\nMultiple likelihood fit for improving tau fakes uncertainty\r\n-----------------------------------------------------------\r\nrunTauDileptonPDFBuilderFitter tauDileptonAnalysisParSets_cfg.py\r\n\r\nRelevant parameters: straightforward cfg file. Must write doc here, though\r\n\r\nProduce shapes:\r\n---------------\r\nproduceLandSShapes tauDileptonAnalysisParSets_cfg.py --produceOnly (true|false [false])\r\n\r\nRelevant parameters: straightforward cfg file.\r\nCommand options: \r\n- produceOnly: (necessary because in plots HH and WH are rescaled, in rootfile not)\r\n               in TBH won't be necessary,  so fuck it.\r\n\t       -True: just produces rootfile with all the shapes, no plot.\r\n\t       -False: [default] just produces plots, no rootfile.\r\n\r\nRun physicsAnalysis - this corresponds to the obsolete PhysicsAnalyzer code\r\n------------------------------------------------------------------\r\n- interactively:\r\n  physicsAnalysis test/physicsAnalysisParSets_cfg.py sample\r\n  (where \"sample\" is ttbar, wjets, etc. Strings can be found in bin/physicsAnalysis.cc)\r\n- on the LIP batch:\r\n  cd scripts/lip-batch/\r\n  sh combineResults.sh path/to/dir clean --> this cleans the output directory in which you want to store the outputs\t\r\n  EDIT submit-jobs.sh in order to change the script path to your local installation.\r\n  EDIT the *output* paths in test/physicsAnalysisParSets_cfg.py . The input are fixed (53X production)\r\n  sh submit-jobs.sh\r\n  qstat -u username --> this checks whether your jobs are running and if they did already finish\r\n  sh combineResults.sh path/to/dir hadd [AB|ABC|ABCD] --> this hadds the relevant output files\r\n  RUN physicsAnalysis test/physicsAnalysisParSets_cfg.py doPlots   ---> this produces plots\r\n  RUN physicsAnalysis test/physicsAnalysisParSets_cfg.py doTables  ---> this produces tables and datacards (if \"higgs\" is turned on)\r\n- have fun\r\n\r\nProduce plots\r\n-------------\r\ncd LIP/TopTaus  # this is necessary, because at the moment bin/physicsAnalysis.cc is configured\r\n                # in such a way as to fetch plots from \"data/plotter/\". Must change to configurable paths via cfg file\r\nmkdir plots\r\nphysicsAnalysis test/physicsAnalysisParSets_cfg.py doPlots\r\n\r\nProduce tables\r\n--------------\r\nphysicsAnalysis test/physicsAnalysisParSets_cfg.py doTables --doDatacards [true|false]\r\n\t\t--doDatacards: true means datacards are produced, and tbh yields are rescaled to the ttbar production cross-section\r\n\t\t\t       false means datacards are not produced, and tbh yields are rescaled to the production cross section of the tbh samples (1.1pb)\r\n\r\nProduce fakerate\r\n----------------\r\nfor a list of all the options:\r\n    doTauFakesStudy test/physicsAnalysisParSets_cfg.py --help \r\nfor running everything:\r\n    doTauFakesStudy test/physicsAnalysisParSets_cfg.py --do all\r\n\r\nDatacards\r\n---------\r\nInstall repository (CMS members only):\r\nsvn co svn+ssh://vischia@svn.cern.ch/reps/lipcms/Physics/datacards lipcms/Physics/datacards\r\nchiggs datacards are in lipcms/Physics/datacards/chiggs/\r\nxsec datacards are in lipcms/Physics/datacards/xsec/\r\nSee lipcms/Physics/datacards/Readme.txt for additional info\r\n\r\n\r\nCHANGELOG for major updates:\r\n2013-05-08: Added H+->tb yields to summary table, and fixed in a consistent way its xsec*BR\r\n\t    H+->taunu and H+->tb are now stacked in plots\r\n\t    Added H+->tb decay to datacards for mH+ = 250GeV/c^2\r\n\t    Committed revision 718 for chiggs datacards\r\n2013-05-07: Reworked table builder for not having to run twice (tables, datacards)\r\n\t    Almost implemented decoupling of event analysis and application of a selection\r\n\t    Switched to text names for nuisance parameters (since february combine likes no numbers - for event counting this is not a problem, but for consistency I switched)\r\n\t    Removed unused nuisance parameters (full-hadronic ones)\r\n2013-05-06: Fixed jer smearing/met propagation (condensed in single loop)\r\n\t    Fixed normalization for datacards and shapes\r\n\t    committed revision 716 for chiggs datacards - supersedes all previous revisions\r\n2013-05-03: Enabled TDRStyle for kNN monitoring plots\r\n\t    Not show anymore ratio in R plot\r\n2013-05-02: Enabled analsis of the new H+->tb (noH+->\\tau\\nu) samples\r\n2013-05-01: Fixed bug in jer smearing propagation to met\r\n2013-04-30: REPOSITORY MOVED TO https://github.com/vischia/TopTaus.git. No more updates will be committed to CERN CVS. After a week of testing at github, LIP/TopTaus/ files will be zeroed with the exception of the Readme.txt\r\n\t    plot fixes\r\n\t    jer smearing to tf\r\n2013-04-29: committed revision 715 for chiggs datacards\r\n\t    cleanup and fix of shapes producer\r\n\t    jer and propagation to met fix\r\n\t    updated fakes values in summary table\r\n2013-04-27: new kinematic variables added\r\n\t    plots ranges for eta tuned\r\n\t    some prefixes for optimization\r\n\t    metscaling testing\r\n\t    cleanup in plots\r\n\t    cleanup in todolist\r\n2013-04-24: 2.41AM: added stat+syst bands in ratio plots\r\n\t    wJetsAnalysis was not using jerc (bugfix)\r\n\t    fixed btag bug for wJetsAnalysis\r\n\t    updated btag scale factors\r\n2013-04-22: fixed bug in variables for OS shapes (it was fixed in 2011 and was never committed to the 2012 branch\r\n\t    added automatic calculation and table of fakes\r\n2013-04-19: added index.html automatically put inside plots directory for easy and fancy propagation of the plots\r\n\t    configured LandsShapesProducer class for heavyChiggs\r\n\t    configured TauDileptonTableBuilder for producing datacards with shapes\r\n\t    committed revision 714 for chiggs datacards\r\n2013-04-18: added mjj vs mjjb study (discrimination sig/ttbarbkg)\r\n\t    added residual mc shape subtraction from dd shape K-S test\r\n\t    added combine installation instructions and datacard automatic maker\t\r\n\t    committed revision 702 for chiggs datacards\r\n\t    added doTauFakesStudy (complete tau fakes study)\r\n2013-04-15: added chiggs BRs to TauDileptonTableBuilder, almost finished tau fakes software\r\n2013-04-08: configured combineResults.sh script for different data hadding schemes \r\n2013-03-27: fixed jet smearing factors\r\n\t    fixed index of muon trigger eff muon, just for completeness\r\n\t    (it was already correct since the collection is already pt-ordered)\r\n2013-03-22: muon trigger efficiencies scale factors added\r\n\t    pileup files splitted per run (data/pileup)\r\n\t    lumi per run added to CommonDefinitions.cc\r\n2013-03-21: lepton-jet masses plots added\r\n2013-03-20: fixed pileup reweighting\r\n\t    added table with the codes for antiLepton discriminators for taus\r\n\t    chosen for chiggs: antiMuonTight for highPt, againstElectronMVA3Medium\r\n\t    added class and executable for training distributions for fakes\r\n2013-03-19: fixed tables for SM ttbar\r\n\t    added table for heavy charged higgs samples\r\n2013-03-18: new data ntuples with improved splitting.\r\n\t    Modified combineResults.sh in order to support directory cleaning\r\n\t    New pileup files, and chosen value: 70300\r\n\t    data/plotter/samples.xml now has just final name path. Full path is read from cfg file (outputArea parameter)\r\n2013-03-05: ported to NCG\r\n\t    improved lip-batch scripting system: now the user path is set once only in submit-jobs.sh\r\n\t    I/O and PU filenames moved to cfg files\r\n2013-02-24: fixes: plotter perfectly working\r\n2013-02-22: plotter and table added and integrated into physicsAnalysis.\r\n2013-02-13: updated with 2012 cross sections - must check sample-specific ones\r\n\t    jet pt, btag, mlj added for leadingjet/nlj/nnlj\r\n2013-02-11: updated JEC uncertainty sources\r\n\t    code is running on samples\r\n\t    lip-batch submission implemented\r\n2013-02-08: ended base porting of the code. Now must move stuff to config file.\r\n2013-02-07: added scripts/getTriggers.sh for easy trigger and prescales fetching\r\n\t    (will be crucial in particular for etau channel, later on)\r\n2013-01-23: Likelihood fitter for tau fakes has RooDataset which will take into account correlations\r\n            when performing the combined fit. Must just switch likelihoods to use it and to\r\n\t    product of likelihoods\r\n2012-12-17: 2011 tagged (V12-12-17), start 2012 heavy developing and code porting\r\n2012-09-23: memory problem solved. Now both lands and mlf are usable with multiple variables\r\n2012-09-21: shapes producer for lands and multiple likelihood fit for fake rates are ready to use.\r\n\r\nFIXED TAGS:\r\n- V13-03-07: full working heavy charged higgs tag\r\n- V12-12-21 / V12-12-17: 2011 code.\r\n\r\nCHANGELOG for datacards:\r\nrev 718 (2013-05-08): cHiggs: H+->tb decay added to mH+=250GeV/c^2 datacard\r\nrev 716 (2013-05-06): cHiggs: fixed yields and shapes. This version supersedes all the previous.\r\nrev 715 (2012-04-29): cHiggs: moved to use pt_tau shapes. Fixed datacards with values after met correction.\r\nrev 714 (2012-04-19): fixed first shapes files and datacards with support for shapes (R_tau) for heavy charged higgs\t\t\r\nrev 713 (2012-04-19): first shapes files and datacards with support for shapes (R_tau) for heavy charged higgs\t\r\nrev 702 (2012-04-18): first counting-only chiggs datacards for heavy charged higgs\r\n\r\n\r\nTODO:\r\n- fix uncertainty band plotting in case the plot is normalized to 1 (Rtau)\r\n- update tau ID uncertainties\r\n- update uncertainties in HistogramPlotter\r\n- move to txt file the cout of the fakes computation in TauFakesHelper.cc (latex table and everything)\r\n- reweight MC distros con q/g fraction evaluated from MC\r\n- From my 2013-04-22 presentation at TauPOG: recalculate fakes feeding the wmu sample the qcd mva and vice versa, try training with more kinematical variables\r\n- move all 234.s in the code (TauDileptonTableBuilder in particular) to the value from SampleProcessor (or move the xsecs to CommonDefinitions, better) \r\n- vstrings in physicsAnalysisParSets_cfg.py for pileup syst\r\n- move path of plots output directory to command line or cfg file.\r\n- split JEC uncertainty sources into the 16 components.\r\n- scripts/getTriggers.hs: implement running through sh getTriggers.sh PARS, in order to allow to choose\r\n  at runtime whether to print the prescales table or just the triggers\r\n\r\n- Make the unbinned fit work, caralho\r\n\r\n- Apply single RooDataset per sample to LandSShapesProducer too\r\n\r\n- Rework of LandSShapesProducer and PDFBuilderFitter\r\n  --> New structure: -> single class for building datasets and models\r\n                     -> one inheriting class for shapes production, storing and plotting (LandSShapesProducer)\r\n\t\t     -> one inheriting class for fitting, saving and plotting (PDFBuilderFitter)\r\n\t\t     -> perhaps one single executable with switch via ParSet in config file\r\n\r\n- Pattuple producer \r\n  --> Acquire and improve version from 2013-01-23 - must upload from lipcms svn - in order to use\r\n      multicrab in the future\r\n\r\n- Ntuples producer --> Convert plugin\r\n\r\n- Analysis code:\r\n                 --> move hardcoded parameters to configuration file via edm::ParameterSet (minimize the need for recompiling)\r\n\t\t --> import batch submission and modify process in order to run on a given subset of events.\r\n\t\t     (add s.th like void processEvents(uint firstEv, uint lastEv, string dataset){ if(string...) CutflowAnalyzer::process_ttbar(.. process(firstEv, lastEv) ..)  }\r\n\t\t     Doing that needs to redefine the total number of events in the event reweighting according to xsec and N_mc_evts\r\n- Tau energy scale for main analysis code. \r\n\r\n- Split fake contribution into e and mu\r\n  --> Evan/Monica 2013-01-23: \"there are different scale factors for e and mu fakes to be applied,\r\n      so you better split the two components in the cutflow yields table\"\r\n\r\n- Fix crash after natural end when running interactively (low priority)      \r\n","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}